# ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UI è©³ç´°è¨­è¨ˆæ›¸

## ãƒ¡ã‚¿æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID | DETAILED-CLI-001-MENUBAR |
| å¯¾å¿œæ©Ÿèƒ½ | F-018 (ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼å¸¸é§), F-004 (æ™‚é–“è¡¨ç¤º) |
| å¯¾å¿œè¦ä»¶ | REQ-CLI-001 |
| å¯¾å¿œåŸºæœ¬è¨­è¨ˆ | BASIC-CLI-001 |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 1.0.0 |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ãƒ‰ãƒ©ãƒ•ãƒˆ |
| ä½œæˆæ—¥ | 2026-01-03 |
| æœ€çµ‚æ›´æ–°æ—¥ | 2026-01-03 |
| ä½œæˆè€… | - |

---

## 1. æ¦‚è¦

### 1.1 ç›®çš„

æœ¬è¨­è¨ˆæ›¸ã¯ã€macOSãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼CLIãƒ„ãƒ¼ãƒ«ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UIæ©Ÿèƒ½ã®è©³ç´°è¨­è¨ˆã‚’å®šç¾©ã™ã‚‹ã€‚`tray-icon` ã‚¯ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¸¸é§ã•ã›ã€æ®‹ã‚Šæ™‚é–“ã®è¡¨ç¤ºã¨ã‚¯ã‚¤ãƒƒã‚¯æ“ä½œã‚’æä¾›ã™ã‚‹ã€‚

### 1.2 ã‚¹ã‚³ãƒ¼ãƒ—

#### ã‚¹ã‚³ãƒ¼ãƒ—å†…
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã®ä½œæˆã¨è¡¨ç¤º
- æ®‹ã‚Šæ™‚é–“ã®å‹•çš„æ›´æ–°ï¼ˆ1ç§’ã”ã¨ï¼‰
- ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®æ§‹ç¯‰
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
- Daemonã‚µãƒ¼ãƒãƒ¼ã¨ã®çŠ¶æ…‹åŒæœŸ
- ã‚¢ã‚¤ã‚³ãƒ³ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆPNGç”»åƒï¼‰
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼åˆ©ç”¨ä¸å¯æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### ã‚¹ã‚³ãƒ¼ãƒ—å¤–
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ©Ÿèƒ½ï¼ˆPhase 2ï¼‰
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹æ©Ÿèƒ½ï¼ˆPhase 2ï¼‰
- é€šçŸ¥ã‚»ãƒ³ã‚¿ãƒ¼ã¨ã®é€£æºï¼ˆåˆ¥è¨­è¨ˆæ›¸ï¼‰

### 1.3 ç”¨èªå®šç¾©

| ç”¨èª | å®šç¾© |
|------|------|
| ãƒˆãƒ¬ã‚¤ã‚¢ã‚¤ã‚³ãƒ³ | macOSãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹å¸¸é§ã‚¢ã‚¤ã‚³ãƒ³ |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¢ã‚¤ãƒ†ãƒ  | macOSã®NSStatusItemã«ç›¸å½“ã™ã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼è¦ç´  |
| ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ç™ºç«ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ |
| çŠ¶æ…‹åŒæœŸ | Daemonã‚µãƒ¼ãƒãƒ¼ã®ã‚¿ã‚¤ãƒãƒ¼çŠ¶æ…‹ã¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UIã®åŒæœŸ |

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### 2.1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```mermaid
flowchart TB
    subgraph Daemon["Daemonã‚µãƒ¼ãƒãƒ¼"]
        D1[ã‚¿ã‚¤ãƒãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³]
        D2[çŠ¶æ…‹ç®¡ç†<br/>TimerState]
        D3[ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼]
    end

    subgraph MenuBar["ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«"]
        M1[TrayIconBuilder<br/>ã‚¢ã‚¤ã‚³ãƒ³ä½œæˆ]
        M2[IconManager<br/>ã‚¢ã‚¤ã‚³ãƒ³ç®¡ç†]
        M3[MenuBuilder<br/>ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰]
        M4[EventHandler<br/>ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†]
    end

    subgraph macOS["macOS API"]
        OS1[NSStatusBar]
        OS2[NSMenu]
    end

    D1 --> D2
    D2 --> D3
    D3 --> M1
    M1 --> M2
    M1 --> M3
    M3 --> M4
    M4 -.->|"IPCçµŒç”±"| D1
    M1 --> OS1
    M3 --> OS2
```

### 2.2 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

```
src/menubar/
â”œâ”€â”€ mod.rs              # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€TrayIconManager
â”œâ”€â”€ icon.rs             # IconManager: ã‚¢ã‚¤ã‚³ãƒ³ç”Ÿæˆãƒ»æ›´æ–°
â”œâ”€â”€ menu.rs             # MenuBuilder: ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰
â””â”€â”€ event.rs            # EventHandler: ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
```

### 2.3 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    autonumber
    participant T as ã‚¿ã‚¤ãƒãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³
    participant S as çŠ¶æ…‹ç®¡ç†
    participant M as ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
    participant I as IconManager
    participant MB as MenuBuilder
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼

    T->>S: çŠ¶æ…‹æ›´æ–°ï¼ˆæ®‹ã‚Šæ™‚é–“: 1499ç§’ï¼‰
    S->>M: çŠ¶æ…‹å¤‰æ›´é€šçŸ¥
    M->>I: ã‚¢ã‚¤ã‚³ãƒ³æ›´æ–°ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    I->>I: ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆï¼ˆğŸ… 24:59ï¼‰
    I->>OS: NSStatusItemæ›´æ–°
    OS-->>U: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«è¡¨ç¤º
    U->>OS: ã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯
    OS->>MB: ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    MB->>MB: ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰ï¼ˆç¾åœ¨çŠ¶æ…‹åæ˜ ï¼‰
    MB->>OS: NSMenuè¡¨ç¤º
    U->>OS: ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®é¸æŠï¼ˆä¸€æ™‚åœæ­¢ï¼‰
    OS->>EventHandler: MenuEventç™ºç«
    EventHandler->>T: IPCçµŒç”±ã§pauseã‚³ãƒãƒ³ãƒ‰é€ä¿¡
```

---

## 3. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ

### 3.1 mod.rs - TrayIconManager

#### 3.1.1 è²¬å‹™

- ãƒˆãƒ¬ã‚¤ã‚¢ã‚¤ã‚³ãƒ³ã®åˆæœŸåŒ–ã¨ç®¡ç†
- çŠ¶æ…‹å¤‰æ›´ã®ç›£è¦–ã¨æ›´æ–°ãƒˆãƒªã‚¬ãƒ¼
- IconManagerã€MenuBuilderã®çµ±åˆ

#### 3.1.2 æ§‹é€ ä½“å®šç¾©

```rust
/// ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã®ç®¡ç†
pub struct TrayIconManager {
    /// tray-iconã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
    tray_icon: TrayIcon,
    /// ã‚¢ã‚¤ã‚³ãƒ³ç®¡ç†
    icon_manager: IconManager,
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰
    menu_builder: MenuBuilder,
    /// ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
    event_handler: Arc<EventHandler>,
    /// ç¾åœ¨ã®çŠ¶æ…‹
    current_state: Arc<RwLock<TimerState>>,
}

impl TrayIconManager {
    /// æ–°ã—ã„TrayIconManagerã‚’ä½œæˆ
    pub fn new(ipc_client: Arc<IpcClient>) -> Result<Self>;
    
    /// ãƒˆãƒ¬ã‚¤ã‚¢ã‚¤ã‚³ãƒ³ã‚’åˆæœŸåŒ–
    pub fn initialize(&mut self) -> Result<()>;
    
    /// çŠ¶æ…‹ã‚’æ›´æ–°ï¼ˆ1ç§’ã”ã¨ã«å‘¼ã°ã‚Œã‚‹ï¼‰
    pub fn update_state(&mut self, state: TimerState) -> Result<()>;
    
    /// ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹
    pub fn run_event_loop(&self) -> Result<()>;
    
    /// ãƒˆãƒ¬ã‚¤ã‚¢ã‚¤ã‚³ãƒ³ã‚’å‰Šé™¤
    pub fn shutdown(&mut self) -> Result<()>;
}
```

#### 3.1.3 å®Ÿè£…æ–¹é‡

- `TrayIconBuilder` ã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½œæˆ
- çŠ¶æ…‹æ›´æ–°ã¯ `Arc<RwLock<TimerState>>` ã§å…±æœ‰
- ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã¯ `tray_icon::menu::MenuEvent::receiver()` ã‚’ä½¿ç”¨
- ã‚¨ãƒ©ãƒ¼æ™‚ã¯è­¦å‘Šãƒ­ã‚°ã‚’å‡ºåŠ›ã—ã€æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„ï¼‰

### 3.2 icon.rs - IconManager

#### 3.2.1 è²¬å‹™

- ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã®ç”Ÿæˆã¨ç®¡ç†
- æ®‹ã‚Šæ™‚é–“ãƒ†ã‚­ã‚¹ãƒˆã®å‹•çš„ç”Ÿæˆ
- çŠ¶æ…‹ã«å¿œã˜ãŸã‚¢ã‚¤ã‚³ãƒ³åˆ‡ã‚Šæ›¿ãˆï¼ˆä½œæ¥­ä¸­/ä¼‘æ†©ä¸­/åœæ­¢ä¸­ï¼‰

#### 3.2.2 æ§‹é€ ä½“å®šç¾©

```rust
/// ã‚¢ã‚¤ã‚³ãƒ³ç®¡ç†
pub struct IconManager {
    /// ä½œæ¥­ä¸­ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆğŸ…ï¼‰
    working_icon: Icon,
    /// ä¼‘æ†©ä¸­ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆâ˜•ï¼‰
    breaking_icon: Icon,
    /// åœæ­¢ä¸­ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰
    stopped_icon: Icon,
}

impl IconManager {
    /// æ–°ã—ã„IconManagerã‚’ä½œæˆ
    pub fn new() -> Result<Self>;
    
    /// çŠ¶æ…‹ã«å¿œã˜ãŸã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ
    /// ä¾‹: "ğŸ… 15:30", "â˜• 04:30", "â¸ åœæ­¢ä¸­"
    pub fn generate_title(&self, state: &TimerState) -> String;
    
    /// çŠ¶æ…‹ã«å¿œã˜ãŸã‚¢ã‚¤ã‚³ãƒ³ã‚’å–å¾—
    pub fn get_icon(&self, phase: &TimerPhase) -> &Icon;
    
    /// ã‚¢ã‚¤ã‚³ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã¿
    fn load_icon(path: &str) -> Result<Icon>;
}
```

#### 3.2.3 ã‚¢ã‚¤ã‚³ãƒ³ãƒªã‚½ãƒ¼ã‚¹

| çŠ¶æ…‹ | ã‚¢ã‚¤ã‚³ãƒ³ | ãƒ•ã‚¡ã‚¤ãƒ«å | ã‚µã‚¤ã‚º |
|------|---------|-----------|--------|
| ä½œæ¥­ä¸­ | ğŸ… | `working.png` | 22x22 @2x |
| ä¼‘æ†©ä¸­ | â˜• | `breaking.png` | 22x22 @2x |
| åœæ­¢ä¸­ | â¸ | `stopped.png` | 22x22 @2x (ã‚°ãƒ¬ãƒ¼) |

**é…ç½®å ´æ‰€**: `assets/icons/menubar/`

#### 3.2.4 ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯

```rust
pub fn generate_title(&self, state: &TimerState) -> String {
    match state.phase {
        TimerPhase::Working => {
            let minutes = state.remaining_seconds / 60;
            let seconds = state.remaining_seconds % 60;
            format!("ğŸ… {:02}:{:02}", minutes, seconds)
        }
        TimerPhase::Breaking | TimerPhase::LongBreaking => {
            let minutes = state.remaining_seconds / 60;
            let seconds = state.remaining_seconds % 60;
            format!("â˜• {:02}:{:02}", minutes, seconds)
        }
        TimerPhase::Paused => {
            format!("â¸ ä¸€æ™‚åœæ­¢")
        }
        TimerPhase::Stopped => {
            format!("â¸ åœæ­¢ä¸­")
        }
    }
}
```

### 3.3 menu.rs - MenuBuilder

#### 3.3.1 è²¬å‹™

- ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®æ§‹ç¯‰
- çŠ¶æ…‹ã«å¿œã˜ãŸãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã®æœ‰åŠ¹/ç„¡åŠ¹åŒ–
- ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®æŒ¿å…¥

#### 3.3.2 æ§‹é€ ä½“å®šç¾©

```rust
/// ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰
pub struct MenuBuilder {
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
    menu: Menu,
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ID
    item_ids: MenuItemIds,
}

/// ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã®IDç®¡ç†
pub struct MenuItemIds {
    pub pause: MenuItemId,
    pub resume: MenuItemId,
    pub stop: MenuItemId,
    pub quit: MenuItemId,
}

impl MenuBuilder {
    /// æ–°ã—ã„MenuBuilderã‚’ä½œæˆ
    pub fn new() -> Result<Self>;
    
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æ§‹ç¯‰
    pub fn build(&mut self, state: &TimerState) -> Result<&Menu>;
    
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã®æœ‰åŠ¹/ç„¡åŠ¹ã‚’æ›´æ–°
    pub fn update_menu_state(&mut self, state: &TimerState) -> Result<()>;
    
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å–å¾—
    pub fn menu(&self) -> &Menu;
}
```

#### 3.3.3 ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹é€ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼       â”‚ (ã‚¿ã‚¤ãƒˆãƒ«ã€ç„¡åŠ¹åŒ–)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½œæ¥­ä¸­: APIå®Ÿè£…          â”‚ (çŠ¶æ…‹è¡¨ç¤ºã€ç„¡åŠ¹åŒ–)
â”‚ æ®‹ã‚Šæ™‚é–“: 15:30          â”‚ (æ®‹ã‚Šæ™‚é–“ã€ç„¡åŠ¹åŒ–)
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­: #2           â”‚ (å›æ•°ã€ç„¡åŠ¹åŒ–)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â¸ ä¸€æ™‚åœæ­¢              â”‚ (ä½œæ¥­ä¸­ã®ã¿æœ‰åŠ¹)
â”‚ â–¶ å†é–‹                  â”‚ (ä¸€æ™‚åœæ­¢ä¸­ã®ã¿æœ‰åŠ¹)
â”‚ â¹ åœæ­¢                  â”‚ (å®Ÿè¡Œä¸­ã®ã¿æœ‰åŠ¹)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çµ‚äº†                    â”‚ (å¸¸ã«æœ‰åŠ¹)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.4 ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã®æœ‰åŠ¹/ç„¡åŠ¹ãƒ­ã‚¸ãƒƒã‚¯

| ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® | æœ‰åŠ¹æ¡ä»¶ |
|-------------|---------|
| ä¸€æ™‚åœæ­¢ | `phase == Working || phase == Breaking` |
| å†é–‹ | `phase == Paused` |
| åœæ­¢ | `phase != Stopped` |
| çµ‚äº† | å¸¸ã«æœ‰åŠ¹ |

#### 3.3.5 å®Ÿè£…ä¾‹

```rust
pub fn build(&mut self, state: &TimerState) -> Result<&Menu> {
    self.menu.clear()?;
    
    // ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆç„¡åŠ¹åŒ–ï¼‰
    let title = MenuItem::new("ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼", false, None);
    self.menu.append(&title)?;
    
    self.menu.append(&PredefinedMenuItem::separator())?;
    
    // çŠ¶æ…‹è¡¨ç¤ºï¼ˆç„¡åŠ¹åŒ–ï¼‰
    if let Some(task_name) = &state.task_name {
        let status = MenuItem::new(
            &format!("ä½œæ¥­ä¸­: {}", task_name),
            false,
            None
        );
        self.menu.append(&status)?;
    }
    
    let remaining = MenuItem::new(
        &format!("æ®‹ã‚Šæ™‚é–“: {:02}:{:02}", 
            state.remaining_seconds / 60,
            state.remaining_seconds % 60),
        false,
        None
    );
    self.menu.append(&remaining)?;
    
    let count = MenuItem::new(
        &format!("ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­: #{}", state.pomodoro_count),
        false,
        None
    );
    self.menu.append(&count)?;
    
    self.menu.append(&PredefinedMenuItem::separator())?;
    
    // æ“ä½œãƒ¡ãƒ‹ãƒ¥ãƒ¼
    let pause_enabled = matches!(state.phase, TimerPhase::Working | TimerPhase::Breaking);
    let pause = MenuItem::new("â¸ ä¸€æ™‚åœæ­¢", pause_enabled, None);
    self.item_ids.pause = pause.id();
    self.menu.append(&pause)?;
    
    let resume_enabled = matches!(state.phase, TimerPhase::Paused);
    let resume = MenuItem::new("â–¶ å†é–‹", resume_enabled, None);
    self.item_ids.resume = resume.id();
    self.menu.append(&resume)?;
    
    let stop_enabled = !matches!(state.phase, TimerPhase::Stopped);
    let stop = MenuItem::new("â¹ åœæ­¢", stop_enabled, None);
    self.item_ids.stop = stop.id();
    self.menu.append(&stop)?;
    
    self.menu.append(&PredefinedMenuItem::separator())?;
    
    // çµ‚äº†
    let quit = MenuItem::new("çµ‚äº†", true, None);
    self.item_ids.quit = quit.id();
    self.menu.append(&quit)?;
    
    Ok(&self.menu)
}
```

### 3.4 event.rs - EventHandler

#### 3.4.1 è²¬å‹™

- ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®å—ä¿¡
- ã‚¤ãƒ™ãƒ³ãƒˆã«å¿œã˜ãŸã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œï¼ˆIPCçµŒç”±ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### 3.4.2 æ§‹é€ ä½“å®šç¾©

```rust
/// ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
pub struct EventHandler {
    /// IPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
    ipc_client: Arc<IpcClient>,
    /// ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ID
    item_ids: MenuItemIds,
}

impl EventHandler {
    /// æ–°ã—ã„EventHandlerã‚’ä½œæˆ
    pub fn new(ipc_client: Arc<IpcClient>, item_ids: MenuItemIds) -> Self;
    
    /// ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‡¦ç†
    pub async fn handle_event(&self, event: MenuEvent) -> Result<()>;
    
    /// ä¸€æ™‚åœæ­¢ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡
    async fn handle_pause(&self) -> Result<()>;
    
    /// å†é–‹ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡
    async fn handle_resume(&self) -> Result<()>;
    
    /// åœæ­¢ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡
    async fn handle_stop(&self) -> Result<()>;
    
    /// çµ‚äº†ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡
    async fn handle_quit(&self) -> Result<()>;
}
```

#### 3.4.3 ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    autonumber
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant M as ãƒ¡ãƒ‹ãƒ¥ãƒ¼
    participant E as EventHandler
    participant I as IPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
    participant D as Daemon

    U->>M: ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚¯ãƒªãƒƒã‚¯ï¼ˆä¸€æ™‚åœæ­¢ï¼‰
    M->>E: MenuEventç™ºç«
    E->>E: ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥åˆ¤å®š
    E->>I: pauseã‚³ãƒãƒ³ãƒ‰é€ä¿¡
    I->>D: {"command": "pause"}
    D-->>I: {"status": "success"}
    I-->>E: Result<Response>
    E->>E: ãƒ­ã‚°å‡ºåŠ›ï¼ˆæˆåŠŸ/å¤±æ•—ï¼‰
```

#### 3.4.4 å®Ÿè£…ä¾‹

```rust
pub async fn handle_event(&self, event: MenuEvent) -> Result<()> {
    if event.id == self.item_ids.pause {
        self.handle_pause().await?;
    } else if event.id == self.item_ids.resume {
        self.handle_resume().await?;
    } else if event.id == self.item_ids.stop {
        self.handle_stop().await?;
    } else if event.id == self.item_ids.quit {
        self.handle_quit().await?;
    }
    Ok(())
}

async fn handle_pause(&self) -> Result<()> {
    tracing::info!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‹ã‚‰ä¸€æ™‚åœæ­¢ã‚’å®Ÿè¡Œ");
    let response = self.ipc_client.send_command("pause", None).await?;
    if response.status == "success" {
        tracing::info!("ä¸€æ™‚åœæ­¢æˆåŠŸ");
    } else {
        tracing::error!("ä¸€æ™‚åœæ­¢å¤±æ•—: {}", response.message);
    }
    Ok(())
}
```

---

## 4. ã‚¢ã‚¤ã‚³ãƒ³ç®¡ç†

### 4.1 ã‚¢ã‚¤ã‚³ãƒ³ãƒªã‚½ãƒ¼ã‚¹ä»•æ§˜

#### 4.1.1 ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼

- **å½¢å¼**: PNGï¼ˆé€éèƒŒæ™¯ï¼‰
- **ã‚µã‚¤ã‚º**: 22x22 ãƒ”ã‚¯ã‚»ãƒ«ï¼ˆ@1xï¼‰ã€44x44 ãƒ”ã‚¯ã‚»ãƒ«ï¼ˆ@2xï¼‰
- **ã‚«ãƒ©ãƒ¼**: ãƒ•ãƒ«ã‚«ãƒ©ãƒ¼ï¼ˆä½œæ¥­ä¸­: ãƒˆãƒãƒˆè‰²ã€ä¼‘æ†©ä¸­: ã‚³ãƒ¼ãƒ’ãƒ¼è‰²ã€åœæ­¢ä¸­: ã‚°ãƒ¬ãƒ¼ï¼‰

#### 4.1.2 ãƒªã‚½ãƒ¼ã‚¹é…ç½®

```
assets/icons/menubar/
â”œâ”€â”€ working.png       # ä½œæ¥­ä¸­ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆğŸ…ï¼‰
â”œâ”€â”€ working@2x.png    # Retinaå¯¾å¿œ
â”œâ”€â”€ breaking.png      # ä¼‘æ†©ä¸­ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆâ˜•ï¼‰
â”œâ”€â”€ breaking@2x.png   # Retinaå¯¾å¿œ
â”œâ”€â”€ stopped.png       # åœæ­¢ä¸­ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆâ¸ï¼‰
â””â”€â”€ stopped@2x.png    # Retinaå¯¾å¿œ
```

#### 4.1.3 ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿

```rust
fn load_icon(path: &str) -> Result<Icon> {
    let icon_data = include_bytes!(path);
    let image = image::load_from_memory(icon_data)
        .context("ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—")?;
    
    let rgba = image.to_rgba8();
    let (width, height) = rgba.dimensions();
    
    Icon::from_rgba(rgba.into_raw(), width, height)
        .context("ã‚¢ã‚¤ã‚³ãƒ³ã®ä½œæˆã«å¤±æ•—")
}
```

### 4.2 å‹•çš„ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°

#### 4.2.1 æ›´æ–°é »åº¦

- **é »åº¦**: 1ç§’ã”ã¨
- **ãƒˆãƒªã‚¬ãƒ¼**: ã‚¿ã‚¤ãƒãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰ã®çŠ¶æ…‹å¤‰æ›´é€šçŸ¥

#### 4.2.2 æ›´æ–°å‡¦ç†

```rust
pub fn update_state(&mut self, state: TimerState) -> Result<()> {
    // çŠ¶æ…‹ã‚’æ›´æ–°
    *self.current_state.write().unwrap() = state.clone();
    
    // ã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ
    let title = self.icon_manager.generate_title(&state);
    
    // ãƒˆãƒ¬ã‚¤ã‚¢ã‚¤ã‚³ãƒ³ã‚’æ›´æ–°
    self.tray_icon.set_title(Some(&title))?;
    
    // ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã‚’æ›´æ–°ï¼ˆçŠ¶æ…‹å¤‰åŒ–æ™‚ã®ã¿ï¼‰
    let icon = self.icon_manager.get_icon(&state.phase);
    self.tray_icon.set_icon(Some(icon.clone()))?;
    
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æ›´æ–°
    self.menu_builder.update_menu_state(&state)?;
    
    Ok(())
}
```

---

## 5. ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹é€ 

### 5.1 ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®å®šç¾©

| # | é …ç›®å | ç¨®åˆ¥ | æœ‰åŠ¹æ¡ä»¶ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|---|--------|------|---------|-----------|
| 1 | ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ | ã‚¿ã‚¤ãƒˆãƒ« | å¸¸ã«ç„¡åŠ¹ | ãªã— |
| 2 | ï¼ˆã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰ | ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ | - | - |
| 3 | ä½œæ¥­ä¸­: {ã‚¿ã‚¹ã‚¯å} | çŠ¶æ…‹è¡¨ç¤º | ã‚¿ã‚¹ã‚¯åè¨­å®šæ™‚ã®ã¿è¡¨ç¤ºã€å¸¸ã«ç„¡åŠ¹ | ãªã— |
| 4 | æ®‹ã‚Šæ™‚é–“: {MM:SS} | çŠ¶æ…‹è¡¨ç¤º | å¸¸ã«ç„¡åŠ¹ | ãªã— |
| 5 | ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­: #{å›æ•°} | çŠ¶æ…‹è¡¨ç¤º | å¸¸ã«ç„¡åŠ¹ | ãªã— |
| 6 | ï¼ˆã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰ | ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ | - | - |
| 7 | â¸ ä¸€æ™‚åœæ­¢ | æ“ä½œ | ä½œæ¥­ä¸­ã¾ãŸã¯ä¼‘æ†©ä¸­ | pauseã‚³ãƒãƒ³ãƒ‰é€ä¿¡ |
| 8 | â–¶ å†é–‹ | æ“ä½œ | ä¸€æ™‚åœæ­¢ä¸­ | resumeã‚³ãƒãƒ³ãƒ‰é€ä¿¡ |
| 9 | â¹ åœæ­¢ | æ“ä½œ | åœæ­¢ä¸­ä»¥å¤– | stopã‚³ãƒãƒ³ãƒ‰é€ä¿¡ |
| 10 | ï¼ˆã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰ | ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ | - | - |
| 11 | çµ‚äº† | æ“ä½œ | å¸¸ã«æœ‰åŠ¹ | Daemonçµ‚äº† |

### 5.2 çŠ¶æ…‹åˆ¥ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºä¾‹

#### 5.2.1 ä½œæ¥­ä¸­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½œæ¥­ä¸­: APIå®Ÿè£…          â”‚
â”‚ æ®‹ã‚Šæ™‚é–“: 15:30          â”‚
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­: #2           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â¸ ä¸€æ™‚åœæ­¢              â”‚ â† æœ‰åŠ¹
â”‚ â–¶ å†é–‹                  â”‚ â† ç„¡åŠ¹ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
â”‚ â¹ åœæ­¢                  â”‚ â† æœ‰åŠ¹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çµ‚äº†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.2.2 ä¸€æ™‚åœæ­¢ä¸­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½œæ¥­ä¸­: APIå®Ÿè£…          â”‚
â”‚ æ®‹ã‚Šæ™‚é–“: 15:30          â”‚
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­: #2           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â¸ ä¸€æ™‚åœæ­¢              â”‚ â† ç„¡åŠ¹ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
â”‚ â–¶ å†é–‹                  â”‚ â† æœ‰åŠ¹
â”‚ â¹ åœæ­¢                  â”‚ â† æœ‰åŠ¹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çµ‚äº†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.2.3 åœæ­¢ä¸­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åœæ­¢ä¸­                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â¸ ä¸€æ™‚åœæ­¢              â”‚ â† ç„¡åŠ¹ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
â”‚ â–¶ å†é–‹                  â”‚ â† ç„¡åŠ¹ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
â”‚ â¹ åœæ­¢                  â”‚ â† ç„¡åŠ¹ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çµ‚äº†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—

### 6.1 ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—è¨­è¨ˆ

#### 6.1.1 ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡æ–¹å¼

- `tray_icon::menu::MenuEvent::receiver()` ã‚’ä½¿ç”¨
- ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°å—ä¿¡ï¼ˆ`recv()`ï¼‰ã§ã‚¤ãƒ™ãƒ³ãƒˆå¾…æ©Ÿ
- åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œï¼ˆDaemonã®ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ãªã„ï¼‰

#### 6.1.2 å®Ÿè£…ä¾‹

```rust
pub fn run_event_loop(&self) -> Result<()> {
    let event_handler = self.event_handler.clone();
    let receiver = MenuEvent::receiver();
    
    std::thread::spawn(move || {
        loop {
            if let Ok(event) = receiver.recv() {
                // éåŒæœŸãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
                tokio::runtime::Handle::current().block_on(async {
                    if let Err(e) = event_handler.handle_event(event).await {
                        tracing::error!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚¨ãƒ©ãƒ¼: {:?}", e);
                    }
                });
            }
        }
    });
    
    Ok(())
}
```

### 6.2 ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ãƒ•ãƒ­ãƒ¼

```mermaid
flowchart TB
    Start([ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—é–‹å§‹])
    Wait[MenuEventå—ä¿¡å¾…æ©Ÿ]
    Receive{ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡}
    Identify[ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥åˆ¤å®š]
    Execute[ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ<br/>IPCçµŒç”±]
    Log[ãƒ­ã‚°å‡ºåŠ›]
    Error{ã‚¨ãƒ©ãƒ¼?}
    ErrorLog[ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›]
    Continue[æ¬¡ã®ã‚¤ãƒ™ãƒ³ãƒˆå¾…æ©Ÿ]
    
    Start --> Wait
    Wait --> Receive
    Receive -->|ã‚¤ãƒ™ãƒ³ãƒˆã‚ã‚Š| Identify
    Identify --> Execute
    Execute --> Error
    Error -->|æˆåŠŸ| Log
    Error -->|å¤±æ•—| ErrorLog
    Log --> Continue
    ErrorLog --> Continue
    Continue --> Wait
```

---

## 7. çŠ¶æ…‹åŒæœŸ

### 7.1 Daemonã¨ã®åŒæœŸæ–¹å¼

#### 7.1.1 åŒæœŸãƒˆãƒªã‚¬ãƒ¼

| ãƒˆãƒªã‚¬ãƒ¼ | é »åº¦ | å‡¦ç†å†…å®¹ |
|---------|------|---------|
| ã‚¿ã‚¤ãƒãƒ¼ãƒ†ã‚£ãƒƒã‚¯ | 1ç§’ã”ã¨ | æ®‹ã‚Šæ™‚é–“æ›´æ–°ã€ã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–° |
| çŠ¶æ…‹å¤‰æ›´ | ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ | ãƒ•ã‚§ãƒ¼ã‚ºå¤‰æ›´ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®æœ‰åŠ¹/ç„¡åŠ¹æ›´æ–° |
| ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œæ™‚ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ |

#### 7.1.2 åŒæœŸãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    autonumber
    participant T as ã‚¿ã‚¤ãƒãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³
    participant S as çŠ¶æ…‹ç®¡ç†
    participant M as ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
    participant I as IconManager
    participant MB as MenuBuilder

    loop 1ç§’ã”ã¨
        T->>S: æ®‹ã‚Šæ™‚é–“ãƒ‡ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
        S->>M: çŠ¶æ…‹å¤‰æ›´é€šçŸ¥
        M->>I: ã‚¢ã‚¤ã‚³ãƒ³æ›´æ–°
        I->>OS: NSStatusItemæ›´æ–°
    end
    
    T->>S: ãƒ•ã‚§ãƒ¼ã‚ºå¤‰æ›´ï¼ˆWorking â†’ Breakingï¼‰
    S->>M: çŠ¶æ…‹å¤‰æ›´é€šçŸ¥
    M->>I: ã‚¢ã‚¤ã‚³ãƒ³åˆ‡ã‚Šæ›¿ãˆ
    M->>MB: ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®æ›´æ–°
    MB->>OS: NSMenuæ›´æ–°
```

### 7.2 çŠ¶æ…‹å…±æœ‰æ–¹å¼

#### 7.2.1 å…±æœ‰ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```rust
/// å…±æœ‰çŠ¶æ…‹
pub struct SharedState {
    /// ã‚¿ã‚¤ãƒãƒ¼çŠ¶æ…‹
    state: Arc<RwLock<TimerState>>,
}

impl SharedState {
    /// çŠ¶æ…‹ã‚’å–å¾—
    pub fn get(&self) -> TimerState {
        self.state.read().unwrap().clone()
    }
    
    /// çŠ¶æ…‹ã‚’æ›´æ–°
    pub fn update(&self, state: TimerState) {
        *self.state.write().unwrap() = state;
    }
}
```

#### 7.2.2 æ›´æ–°é€šçŸ¥æ–¹å¼

- **æ–¹å¼1**: ãƒãƒ¼ãƒªãƒ³ã‚°ï¼ˆ1ç§’ã”ã¨ã«çŠ¶æ…‹ã‚’å–å¾—ï¼‰
- **æ–¹å¼2**: ãƒãƒ£ãƒãƒ«çµŒç”±ã®é€šçŸ¥ï¼ˆ`tokio::sync::watch`ï¼‰

**æ¡ç”¨**: æ–¹å¼2ï¼ˆãƒãƒ£ãƒãƒ«çµŒç”±ï¼‰ã‚’æ¡ç”¨ã—ã€åŠ¹ç‡çš„ãªæ›´æ–°ã‚’å®Ÿç¾

```rust
/// çŠ¶æ…‹å¤‰æ›´é€šçŸ¥ãƒãƒ£ãƒãƒ«
pub struct StateNotifier {
    sender: watch::Sender<TimerState>,
    receiver: watch::Receiver<TimerState>,
}

impl StateNotifier {
    pub fn new(initial_state: TimerState) -> Self {
        let (sender, receiver) = watch::channel(initial_state);
        Self { sender, receiver }
    }
    
    /// çŠ¶æ…‹ã‚’é€šçŸ¥
    pub fn notify(&self, state: TimerState) {
        let _ = self.sender.send(state);
    }
    
    /// çŠ¶æ…‹å¤‰æ›´ã‚’ç›£è¦–
    pub async fn watch(&mut self) -> TimerState {
        self.receiver.changed().await.unwrap();
        self.receiver.borrow().clone()
    }
}
```

---

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 8.1 ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥

| ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥ | ç™ºç”Ÿæ¡ä»¶ | å¯¾å¿œæ–¹é‡ |
|-----------|---------|---------|
| ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼åˆ©ç”¨ä¸å¯ | macOSã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãŒåˆ©ç”¨ã§ããªã„ | è­¦å‘Šãƒ­ã‚°å‡ºåŠ›ã€æ©Ÿèƒ½ç„¡åŠ¹åŒ– |
| ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿å¤±æ•— | ã‚¢ã‚¤ã‚³ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ä½¿ç”¨ |
| ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰å¤±æ•— | ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®è¿½åŠ ã‚¨ãƒ©ãƒ¼ | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã€ç©ºãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º |
| IPCé€šä¿¡ã‚¨ãƒ©ãƒ¼ | Daemonã¨ã®é€šä¿¡å¤±æ•— | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã€ãƒªãƒˆãƒ©ã‚¤ |
| ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚¨ãƒ©ãƒ¼ | ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¤±æ•— | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã€æ¬¡ã®ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ç¶™ç¶š |

### 8.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…

#### 8.2.1 ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼åˆ©ç”¨ä¸å¯æ™‚

```rust
pub fn initialize(&mut self) -> Result<()> {
    match TrayIconBuilder::new()
        .with_menu(Box::new(self.menu_builder.menu().clone()))
        .with_icon(self.icon_manager.get_icon(&TimerPhase::Stopped).clone())
        .build()
    {
        Ok(tray_icon) => {
            self.tray_icon = tray_icon;
            tracing::info!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸ");
            Ok(())
        }
        Err(e) => {
            tracing::warn!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã®åˆæœŸåŒ–ã«å¤±æ•—: {:?}", e);
            tracing::warn!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã™");
            // æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãŒã€Daemonã¯ç¶™ç¶š
            Err(anyhow::anyhow!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼åˆ©ç”¨ä¸å¯"))
        }
    }
}
```

#### 8.2.2 ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿å¤±æ•—æ™‚

```rust
fn load_icon(path: &str) -> Result<Icon> {
    match include_bytes!(path) {
        Ok(icon_data) => {
            // æ­£å¸¸èª­ã¿è¾¼ã¿
            Icon::from_rgba(...)
        }
        Err(e) => {
            tracing::error!("ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿å¤±æ•—: {}, ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨", path);
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ï¼ˆå˜è‰²ï¼‰ã‚’ç”Ÿæˆ
            create_default_icon()
        }
    }
}

fn create_default_icon() -> Result<Icon> {
    // 22x22ã®å˜è‰²ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç”Ÿæˆ
    let rgba = vec![128, 128, 128, 255; 22 * 22 * 4];
    Icon::from_rgba(rgba, 22, 22)
        .context("ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã®ä½œæˆã«å¤±æ•—")
}
```

#### 8.2.3 IPCé€šä¿¡ã‚¨ãƒ©ãƒ¼æ™‚

```rust
async fn handle_pause(&self) -> Result<()> {
    tracing::info!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‹ã‚‰ä¸€æ™‚åœæ­¢ã‚’å®Ÿè¡Œ");
    
    match self.ipc_client.send_command("pause", None).await {
        Ok(response) => {
            if response.status == "success" {
                tracing::info!("ä¸€æ™‚åœæ­¢æˆåŠŸ");
            } else {
                tracing::error!("ä¸€æ™‚åœæ­¢å¤±æ•—: {}", response.message);
            }
            Ok(())
        }
        Err(e) => {
            tracing::error!("IPCé€šä¿¡ã‚¨ãƒ©ãƒ¼: {:?}", e);
            // ãƒªãƒˆãƒ©ã‚¤ã¯è¡Œã‚ãšã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿å‡ºåŠ›
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å†åº¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰æ“ä½œå¯èƒ½
            Err(e)
        }
    }
}
```

### 8.3 ãƒ­ã‚°å‡ºåŠ›

#### 8.3.1 ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

| ãƒ¬ãƒ™ãƒ« | ç”¨é€” | ä¾‹ |
|--------|------|-----|
| ERROR | è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ | IPCé€šä¿¡å¤±æ•—ã€ã‚¢ã‚¤ã‚³ãƒ³ä½œæˆå¤±æ•— |
| WARN | è­¦å‘Šï¼ˆæ©Ÿèƒ½åˆ¶é™ï¼‰ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼åˆ©ç”¨ä¸å¯ |
| INFO | æ­£å¸¸å‹•ä½œ | ã‚¢ã‚¤ã‚³ãƒ³åˆæœŸåŒ–æˆåŠŸã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡ŒæˆåŠŸ |
| DEBUG | ãƒ‡ãƒãƒƒã‚°æƒ…å ± | çŠ¶æ…‹æ›´æ–°ã€ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ |
| TRACE | è©³ç´°ãƒˆãƒ¬ãƒ¼ã‚¹ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®è¿½åŠ ã€ã‚¢ã‚¤ã‚³ãƒ³æ›´æ–° |

#### 8.3.2 ãƒ­ã‚°å‡ºåŠ›ä¾‹

```rust
tracing::info!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸ");
tracing::debug!("çŠ¶æ…‹æ›´æ–°: {:?}", state);
tracing::error!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰ã‚¨ãƒ©ãƒ¼: {:?}", e);
tracing::warn!("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã™");
```

---

## 9. ãƒ†ã‚¹ãƒˆè¨­è¨ˆ

### 9.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

#### 9.1.1 IconManager

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | å…¥åŠ› | æœŸå¾…å‡ºåŠ› |
|-------------|------|---------|
| ä½œæ¥­ä¸­ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ | `TimerState { phase: Working, remaining_seconds: 930 }` | `"ğŸ… 15:30"` |
| ä¼‘æ†©ä¸­ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ | `TimerState { phase: Breaking, remaining_seconds: 270 }` | `"â˜• 04:30"` |
| ä¸€æ™‚åœæ­¢ä¸­ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ | `TimerState { phase: Paused }` | `"â¸ ä¸€æ™‚åœæ­¢"` |
| åœæ­¢ä¸­ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ | `TimerState { phase: Stopped }` | `"â¸ åœæ­¢ä¸­"` |
| ã‚¢ã‚¤ã‚³ãƒ³å–å¾—ï¼ˆä½œæ¥­ä¸­ï¼‰ | `TimerPhase::Working` | `working_icon` |
| ã‚¢ã‚¤ã‚³ãƒ³å–å¾—ï¼ˆä¼‘æ†©ä¸­ï¼‰ | `TimerPhase::Breaking` | `breaking_icon` |

#### 9.1.2 MenuBuilder

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | å…¥åŠ› | æœŸå¾…å‡ºåŠ› |
|-------------|------|---------|
| ä½œæ¥­ä¸­ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰ | `TimerState { phase: Working }` | ä¸€æ™‚åœæ­¢: æœ‰åŠ¹ã€å†é–‹: ç„¡åŠ¹ã€åœæ­¢: æœ‰åŠ¹ |
| ä¸€æ™‚åœæ­¢ä¸­ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰ | `TimerState { phase: Paused }` | ä¸€æ™‚åœæ­¢: ç„¡åŠ¹ã€å†é–‹: æœ‰åŠ¹ã€åœæ­¢: æœ‰åŠ¹ |
| åœæ­¢ä¸­ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹ç¯‰ | `TimerState { phase: Stopped }` | ä¸€æ™‚åœæ­¢: ç„¡åŠ¹ã€å†é–‹: ç„¡åŠ¹ã€åœæ­¢: ç„¡åŠ¹ |
| ã‚¿ã‚¹ã‚¯åè¡¨ç¤º | `TimerState { task_name: Some("APIå®Ÿè£…") }` | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã€Œä½œæ¥­ä¸­: APIå®Ÿè£…ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| ã‚¿ã‚¹ã‚¯åãªã— | `TimerState { task_name: None }` | ã‚¿ã‚¹ã‚¯åãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ãŒè¡¨ç¤ºã•ã‚Œãªã„ |

#### 9.1.3 EventHandler

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | å…¥åŠ› | æœŸå¾…å‹•ä½œ |
|-------------|------|---------|
| ä¸€æ™‚åœæ­¢ã‚¤ãƒ™ãƒ³ãƒˆ | `MenuEvent { id: pause_id }` | `ipc_client.send_command("pause")` ãŒå‘¼ã°ã‚Œã‚‹ |
| å†é–‹ã‚¤ãƒ™ãƒ³ãƒˆ | `MenuEvent { id: resume_id }` | `ipc_client.send_command("resume")` ãŒå‘¼ã°ã‚Œã‚‹ |
| åœæ­¢ã‚¤ãƒ™ãƒ³ãƒˆ | `MenuEvent { id: stop_id }` | `ipc_client.send_command("stop")` ãŒå‘¼ã°ã‚Œã‚‹ |
| çµ‚äº†ã‚¤ãƒ™ãƒ³ãƒˆ | `MenuEvent { id: quit_id }` | Daemonçµ‚äº†å‡¦ç†ãŒå‘¼ã°ã‚Œã‚‹ |

### 9.2 çµ±åˆãƒ†ã‚¹ãƒˆ

#### 9.2.1 çŠ¶æ…‹åŒæœŸãƒ†ã‚¹ãƒˆ

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|-------------|------|---------|
| æ®‹ã‚Šæ™‚é–“æ›´æ–° | 1. ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹<br/>2. 1ç§’å¾…æ©Ÿ<br/>3. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ç¢ºèª | ã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒã€ŒğŸ… 24:59ã€ã«æ›´æ–°ã•ã‚Œã‚‹ |
| ãƒ•ã‚§ãƒ¼ã‚ºå¤‰æ›´ | 1. ä½œæ¥­ã‚¿ã‚¤ãƒãƒ¼å®Œäº†<br/>2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ç¢ºèª | ã‚¢ã‚¤ã‚³ãƒ³ãŒğŸ…ã‹ã‚‰â˜•ã«å¤‰æ›´ã•ã‚Œã‚‹ |
| ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®æ›´æ–° | 1. ä¸€æ™‚åœæ­¢å®Ÿè¡Œ<br/>2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º | ã€Œå†é–‹ã€ãŒæœ‰åŠ¹ã€ã€Œä¸€æ™‚åœæ­¢ã€ãŒç„¡åŠ¹ |

#### 9.2.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|-------------|------|---------|
| IPCé€šä¿¡ã‚¨ãƒ©ãƒ¼ | 1. Daemonåœæ­¢<br/>2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ä¸€æ™‚åœæ­¢å®Ÿè¡Œ | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã€ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„ |
| ã‚¢ã‚¤ã‚³ãƒ³èª­ã¿è¾¼ã¿å¤±æ•— | 1. ã‚¢ã‚¤ã‚³ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤<br/>2. Daemonèµ·å‹• | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ä½¿ç”¨ã€è­¦å‘Šãƒ­ã‚°å‡ºåŠ› |

### 9.3 æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

#### 9.3.1 UIç¢ºèª

| ãƒ†ã‚¹ãƒˆé …ç›® | ç¢ºèªå†…å®¹ |
|-----------|---------|
| ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«ğŸ…ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º | æ®‹ã‚Šæ™‚é–“ãŒã€Œ15:30ã€å½¢å¼ã§è¡¨ç¤ºã•ã‚Œã‚‹ |
| ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º | ã‚¢ã‚¤ã‚³ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® | çŠ¶æ…‹ã«å¿œã˜ã¦é …ç›®ãŒæœ‰åŠ¹/ç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ |
| ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ | ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ |

#### 9.3.2 æ“ä½œç¢ºèª

| ãƒ†ã‚¹ãƒˆé …ç›® | æ“ä½œ | æœŸå¾…çµæœ |
|-----------|------|---------|
| ä¸€æ™‚åœæ­¢ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œä¸€æ™‚åœæ­¢ã€é¸æŠ | ã‚¿ã‚¤ãƒãƒ¼ãŒä¸€æ™‚åœæ­¢ã™ã‚‹ |
| å†é–‹ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œå†é–‹ã€é¸æŠ | ã‚¿ã‚¤ãƒãƒ¼ãŒå†é–‹ã™ã‚‹ |
| åœæ­¢ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œåœæ­¢ã€é¸æŠ | ã‚¿ã‚¤ãƒãƒ¼ãŒåœæ­¢ã™ã‚‹ |
| çµ‚äº† | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œçµ‚äº†ã€é¸æŠ | DaemonãŒçµ‚äº†ã™ã‚‹ |

---

## 10. å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| # | ã‚¿ã‚¹ã‚¯ | æ‹…å½“ | æœŸé™ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|---|--------|------|------|-----------|
| 1 | IconManagerå®Ÿè£… | - | 2026-01-09 | æœªç€æ‰‹ |
| 2 | MenuBuilderå®Ÿè£… | - | 2026-01-10 | æœªç€æ‰‹ |
| 3 | EventHandlerå®Ÿè£… | - | 2026-01-11 | æœªç€æ‰‹ |
| 4 | TrayIconManagerå®Ÿè£… | - | 2026-01-12 | æœªç€æ‰‹ |
| 5 | ã‚¢ã‚¤ã‚³ãƒ³ãƒªã‚½ãƒ¼ã‚¹ä½œæˆ | - | 2026-01-08 | æœªç€æ‰‹ |
| 6 | å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£… | - | 2026-01-13 | æœªç€æ‰‹ |
| 7 | çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£… | - | 2026-01-14 | æœªç€æ‰‹ |
| 8 | æ‰‹å‹•ãƒ†ã‚¹ãƒˆ | - | 2026-01-15 | æœªç€æ‰‹ |

---

## 11. æœªè§£æ±ºèª²é¡Œ

| ID | èª²é¡Œ | å¯¾å¿œæ–¹é‡ | æœŸé™ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|----|------|---------|------|-----------|
| I-010 | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼UIã¨Daemonã®åŒæœŸæ–¹æ³• | `tokio::sync::watch` ãƒãƒ£ãƒãƒ«ä½¿ç”¨ | 2026-01-11 | è§£æ±ºæ¸ˆã¿ |
| I-014 | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã®å‹•çš„ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | 1ç§’ã”ã¨ã®æ›´æ–°ã§å•é¡Œãªã„ã‹æ¤œè¨¼ | 2026-01-12 | æœªç€æ‰‹ |
| I-015 | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼åˆ©ç”¨ä¸å¯æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | è­¦å‘Šãƒ­ã‚°å‡ºåŠ›ã€æ©Ÿèƒ½ç„¡åŠ¹åŒ– | 2026-01-09 | è§£æ±ºæ¸ˆã¿ |

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | æ‹…å½“è€… |
|:---|:---|:---|:---|
| 2026-01-03 | 1.0.0 | åˆç‰ˆä½œæˆ | - |
