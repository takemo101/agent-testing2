# 手動テストチェックリスト

macOS Pomodoro Timer CLI の手動テスト項目です。
リリース前に必ず確認してください。

## メタ情報

| 項目 | 内容 |
|------|------|
| 作成日 | 2026-01-03 |
| 対応テスト仕様書 | TEST-CLI-001 Section 5, 13 |
| 対応Issue | #13 |

---

## 1. 初回起動時チェック

### 1.1 通知システム

- [ ] **TC-M-001**: 通知許可ダイアログが表示される
- [ ] **TC-M-002**: 通知許可を承認すると通知が表示される
- [ ] **TC-M-005**: 通知許可を拒否すると警告メッセージが表示される

### 1.2 メニューバー

- [ ] **TC-M-006**: メニューバーに🍅アイコンが表示される

---

## 2. タイマー動作チェック

### 2.1 基本動作

- [ ] タイマー開始時にメニューバーアイコンが更新される（「🍅 25:00」形式）
- [ ] 残り時間が1秒ごとに更新される
- [ ] **TC-M-002**: 作業完了時に「🍅 ポモドーロタイマー」通知が表示される
- [ ] 休憩完了時に「☕ ポモドーロタイマー」通知が表示される

### 2.2 通知アクション

- [ ] **TC-M-003**: 通知の「一時停止」ボタンをクリックするとタイマーが一時停止する
- [ ] 通知の「休憩開始」ボタンをクリックすると休憩タイマーが開始される

### 2.3 メニューバー操作

- [ ] **TC-M-007**: タイマー実行中、「🍅 15:30」形式で残り時間が表示される
- [ ] **TC-M-008**: メニューバーアイコンをクリックするとドロップダウンメニューが表示される
- [ ] **TC-M-009**: タイマー実行中は「一時停止」が有効、「再開」が無効
- [ ] **TC-M-010**: メニューから「一時停止」を選択するとタイマーが一時停止する

---

## 3. フォーカスモードチェック

### 3.1 前提条件

ショートカット.appで以下のショートカットを作成しておく：
- `Enable Work Focus`
- `Disable Work Focus`

### 3.2 テスト項目

- [ ] **TC-M-011**: `pomodoro start --focus-mode` でフォーカスモードがONになる
  - システム環境設定 → 集中モード で確認
- [ ] **TC-M-012**: 休憩開始時にフォーカスモードがOFFになる
- [ ] **TC-M-013**: ショートカット未作成時に警告メッセージが表示される（タイマーは動作）

---

## 4. LaunchAgentチェック

### 4.1 インストール

- [ ] **TC-M-014**: `pomodoro install` を実行
  - `~/Library/LaunchAgents/com.example.pomodoro.plist` が作成される
  - `launchctl list | grep pomodoro` でサービスが表示される

### 4.2 自動起動

- [ ] **TC-M-015**: ログアウト → ログイン後、`pomodoro status` でDaemonが起動していることを確認

### 4.3 アンインストール

- [ ] **TC-M-016**: `pomodoro uninstall` を実行
  - `launchctl list | grep pomodoro` でサービスが表示されない
  - plistファイルが削除される

---

## 5. サウンドチェック

### 5.1 基本動作

- [ ] **TC-M-017**: タイマー完了時にシステムサウンド（Glass）が再生される
- [ ] `--no-sound` フラグでサウンドが再生されない

### 5.2 エッジケース

- [ ] **TC-M-018**: システムサウンドが見つからない場合、埋め込みサウンドが再生される
- [ ] **TC-M-019**: オーディオデバイス未接続時に警告ログが出力される（Daemonは起動）

---

## 6. コード署名チェック

### 6.1 署名済みバイナリ

- [ ] **TC-M-020**: `codesign --verify /path/to/pomodoro` が成功
- [ ] Daemon起動後、通知が正常に表示される

### 6.2 未署名バイナリ（開発時のみ）

- [ ] **TC-M-021**: Daemon起動時に警告メッセージ
- [ ] 通知が表示されない可能性がある（macOSセキュリティポリシーに依存）

---

## 7. パフォーマンスチェック

### 7.1 測定方法

```bash
# CLI起動時間
time pomodoro --help

# メモリ使用量
# Activity Monitor で "pomodoro" プロセスを確認

# CPU使用率
# Activity Monitor でアイドル時のCPU使用率を確認
```

### 7.2 目標値

| 項目 | 目標値 | 実測値 | 合否 |
|------|--------|--------|------|
| **TC-P-001**: CLI起動時間 (`--help`) | 100ms以内 | __ms | [ ] |
| **TC-P-002**: IPC応答時間 (`status`) | 50ms以内 | __ms | [ ] |
| **TC-P-003**: 通知送信遅延 | 500ms以内 | __ms | [ ] |
| **TC-P-004**: サウンド再生遅延 | 100ms以内 | __ms | [ ] |
| **TC-P-005**: メモリ使用量 (Daemon常駐時) | 50MB以下 | __MB | [ ] |
| **TC-P-006**: CPU使用率 (アイドル時) | 1%以下 | __% | [ ] |

---

## 8. リグレッションテスト（リリース前必須）

以下のテストをリリース前に必ず実行：

### 8.1 クリティカルパス

- [ ] 完全なポモドーロサイクル（作業25分 → 休憩5分）
- [ ] 一時停止 → 再開 → 停止のフロー
- [ ] 4ポモドーロ後の長い休憩

### 8.2 通知システム

- [ ] 作業完了通知の表示
- [ ] 休憩完了通知の表示
- [ ] 通知アクションボタンの動作

### 8.3 メニューバーUI

- [ ] アイコン表示
- [ ] 残り時間更新
- [ ] メニュー項目の有効/無効切り替え

### 8.4 LaunchAgent

- [ ] インストール
- [ ] ログイン時自動起動
- [ ] アンインストール

---

## 9. テスト環境

| 項目 | 要件 |
|------|------|
| OS | macOS 12 (Monterey) 以降 |
| Rust | 1.85以上 |
| ハードウェア | オーディオ出力デバイス接続必須 |

---

## 10. 問題報告

テスト中に問題が見つかった場合：

1. GitHub Issueを作成
2. ラベル: `bug`, `priority: high/medium/low`
3. 再現手順を詳細に記載
4. スクリーンショットまたはログを添付

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|:---|:---|:---|
| 2026-01-03 | 1.0.0 | 初版作成 (Issue #13) |
