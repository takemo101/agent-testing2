# フォーカスモード設定ガイド

Pomodoro Timer CLI（`pomodoro`）は、作業セッションの開始に合わせてmacOSの「集中モード（Focus Mode）」を自動的にオンにし、休憩開始時にオフにする機能を備えています。

macOSには集中モードを直接制御する公開APIがないため、このツールでは「ショートカット（Shortcuts.app）」を経由して制御を行います。

## 前提条件

- **OS**: macOS 12 (Monterey) 以降
- **アプリ**: macOS標準の「ショートカット」アプリ

## セットアップ手順

集中モード連携を利用するには、以下の2つのショートカットを作成する必要があります。

### 手順1：ショートカットの作成

1. **ショートカットアプリ**を開きます。
2. **「Enable Work Focus」**という名前で新しいショートカットを作成します。
   - アクションとして「集中モードを設定」を追加します。
   - 設定を「**オン**」にし、任意の集中モード（例：「仕事」や「集中」）を選択します。
   - 終了時間は「オフにするまで」に設定します。
3. **「Disable Work Focus」**という名前で別のショートカットを作成します。
   - アクションとして「集中モードを設定」を追加します。
   - 設定を「**オフ**」にします。

### 手順2：オートメーション許可の設定

ターミナルからショートカットを実行することを許可する必要があります。

1. 「システム設定 > プライバシーとセキュリティ > オートメーション」を開きます。
2. `pomodoro`（または実行しているターミナルアプリ）に対して、ショートカットの制御が許可されていることを確認してください。

## 使い方

タイマー開始時に `--focus-mode`（または `-f`）フラグを付けます。

```bash
pomodoro start --focus-mode
```

これで、作業開始時に「Enable Work Focus」が、休憩開始時に「Disable Work Focus」が自動的に実行されます。

## トラブルシューティング

### ショートカットが見つからないというエラーが出る
ショートカット名が正確に一致しているか確認してください。
- `Enable Work Focus`
- `Disable Work Focus`
※スペースや大文字小文字も正確に一致させる必要があります。

### ショートカットが実行されない
手動でコマンドラインから実行できるか試してみてください。
```bash
/usr/bin/shortcuts run "Enable Work Focus"
```
エラーが表示される場合は、ショートカットアプリ内での設定や権限を確認してください。

### 別の名前のショートカットを使いたい
現在のバージョンではショートカット名は固定されています。将来のアップデートでカスタマイズ機能が追加される予定です。
